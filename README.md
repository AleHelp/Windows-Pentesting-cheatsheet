
# Comandi per info generali sul pc 
Get-ComputerInfo = prendi informazioni della macchina

    Get-Localuser #listi gli utenti nella macchina

Get-ScheduledTask = listi tutti gli schedule task / tasklist

Get-Acl(per listare le access-list dei permessi)

Get-PSDrive = lista i drive dell'ambiente legati a powershell che possono essere variabili,oggetti,registri e volumi.

# Comandi Generali
fl(per ricevere più output) 
ES: 
Get-Acl | fl

Get-Help <nome comando > -Full = ottieni l'help dei comandi,  importante utilizzare __Update-Help -Force__ per aggiornare gli help alla versione più recente

Select-Object = utilizzato per prendere un campo dell'oggetto specifico 
ES:
Get-LocalUser John | Select-Object LastLogon output: 03/02/2019 5:48:32 PM

Get-Command utilizzato per sapere se un comando o .exe è presente in powershell

New-LocalUser = per creare nuovi utenti locali
ES:
New-LocalUser -Name $User -Password (ConvertTo-SecureString -AsPlainText "123456789" -Force)

New-LocalGroup = per creare un nuovo gruppo
ES:
New-LocalGroup -Name $Group

Add-LocalGroupMember aggiungi un utente ad un gruppo
ES:
Add-LocalGroupMember -Group $Group -Name $User

reg query per interrogare i registri

# Comandi WMI(Windows Management Instrumentation)

Get-WmiObject = comando per ottenere oggetti fisici o logici gestibili dal WMi, insiemi a lui di solito va specificato la __-Class__ cioè la classe da recuperare.
ES:
Get-WmiObject -Class Win32_OperatingSystem

# Note

_Wmi è un sottosistema di powershell, che fornisce informazioni dettagliate sul sistema operativo, l'hardware, il software e altre risorse del computer quindi per il system monitoring, fa da framework comune perchè presente sulle varie versioni di Windows_

_MMC(Microsoft managment console) interfaccia gui che permette di aggiungere degli snaps-in(moduli) che estendono le funzionalitè del MMC che ha il compito di monitorare risorse hardware e software._

_Wmi è un sottosistema di powershell, che fornisce informazioni dettagliate sul sistema operativo, l'hardware, il software e altre risorse del computer quindi per il system monitoring, fa da framework comune perchè presente sulle varie versioni di Windows_

_MMC(Microsoft managment console) interfaccia gui che permette di aggiungere degli snaps-in(moduli) che estendono le funzionalitè del MMC che ha il compito di monitorare risorse hardware e software._

_WSL(WIndows subsystem linux) un vero sottosistema che simula l'utilizzo di una shell linux, si installa con questo comando:
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux_

# Note sulla sicurezza in Windows

_SID(Security Identifier) aggiunto a utente,gruppi,domini o a qualsiasi altro entità di sicurezza, viene utilizzato per gestire l'accesso alle risorse_

ES:
_S-1-5-21-674899381-4069889467-2080702030-1002_

_SAM(Security account manager) database interno che contiene le informazioni dei vari utenti come password, hash e nomi utenti, è utilizzato dal LSA(lsass.exe) per l'autenticazione._

_ACL(Access control list) e ACE (Access control entrie) le ACE le troviamo dentro l'ACL, le ACE possono avere diverse regole come: deny o allow e si applicano su risorse e utenti._

_UAC(User Access ControlL) utilizzato per non fare eseguire codice o script malevoli, in quanto richiede i priviliegi di amministratore._

_AppLocker permette un controllo granulare di script e dll, permette di aggiungere delle regole sempre su di loro._

_Local group policy utilizzato per le policy di sicurezza dei gruppi._



